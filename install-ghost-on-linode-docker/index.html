<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    
    <title>Install Ghost on Linode Docker Â· ETdoFresh</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    
    <link rel="stylesheet" href="/style.main.min.5ea2f07be7e07e221a7112a3095b89d049b96c48b831f16f1015bf2d95d914e5.css" />

</head>
<body class=" post-template ">

    <div class="site-wrapper">

<header class="site-header"><div class="outer site-nav-main">
    <div class="inner"><nav class="site-nav">
    <div class="site-nav-left">
        <a class="site-nav-logo" href="/"><img src="/images/2020/07/ETdoFresh-1.png" alt="ETdoFresh" /></a>
        
        <div class="site-nav-content">
            <ul class="nav" role="menu">
                
                <li class="nav-home" role="menuitem"><a href="/page/about/">About</a></li>
                
                <li class="nav-home" role="menuitem"><a href="/page/contact/">Contact</a></li>
                
            </ul>
        </div>
        
    </div>
</nav>

</div>
</div></header>

<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post ">

            <header class="post-full-header">

                
                    
                    <section class="post-full-tags">
                        <a href="/tags/ghost">Ghost</a>
                    </section>
                

                <h1 class="post-full-title">Install Ghost on Linode Docker</h1>

                

                <div class="post-full-byline">
                    <section class="post-full-byline-content">
                        <ul class="author-list">
    <li class="author-list-item">
        <div class="author-card">
            <div class="author-profile-image">
  
  
    
      <img src="/uploads/2020/07/23130511_10102476107592788_8763549408590366509_n.jpg" alt="ETdoFresh" />
    
  
</div>
            <div class="author-info">
                <div class="author-info">
                    <h2>ETdoFresh</h2>
                </div>
            </div>
        </div>
        <a href="/author/ETdoFresh" class="author-avatar author-profile-image">
  
  
    
      <img src="/uploads/2020/07/23130511_10102476107592788_8763549408590366509_n.jpg" alt="ETdoFresh" />
    
  
</a>
    </li>
</ul>

                        <section class="post-full-byline-meta">
                            
                                <h4 class="author-name">ETdoFresh</h4>
                            
                            <div class="byline-meta-content">
                                <time class="byline-meta-date" datetime="2020-107-07">5 July 2020</time>
                                <span class="byline-reading-time"><span class="bull">&bull;</span> 6 min read</span>
                            </div>
                        </section>

                    </section>


                </div>
            </header>

            
            <figure class="post-full-image">
                <img src="https://unsplash.com/photos/uWL3al1dom0/download" alt="Install Ghost on Linode Docker" />
            </figure>
            

            <section class="post-full-content">
                <div class="post-content">
                    <p>Hi! Here are the steps I took to install Ghost on a Linode.</p>
<p>Create a &ldquo;Docker&rdquo; Linode. Give it a few minutes to spin up.</p>
<p>Before I got started, I went ahead and made sure my domain was setup correctly in Linode.</p>
<p><img src="/uploads/2020/07/image-20200705164204526.png" alt=""></p>
<p>And make sure your SOA Record and A/AAAA Record are accurate (and pointed to your Linode&rsquo;s IP Address)</p>
<p><img src="/uploads/2020/07/image-20200705164339060.png" alt=""></p>
<p><img src="/uploads/2020/07/image-20200705164432022.png" alt=""></p>
<p>Log into your Linode and create these folders where settings and persistent data should be stored.</p>
<pre><code>mkdir ~/content
mkdir ~/mysql
mkdir ~/nginx-conf
mkdir ~/letsencrypt
</code></pre>
<p>Create ~/nginx-conf/default.conf [Certbot will modify this for https]</p>
<pre><code>server {
  listen 80;
  listen [::]:80;
  server_name etdofresh.com www.etdofresh.com;
  # Useful for Let's Encrypt
  location /.well-known/acme-challenge/ { root /usr/share/nginx/html; allow all; }
  location / {
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-Proto https;
    proxy_pass http://ghost:2368;
  }
}
</code></pre>
<p>Create ~/docker-compose.yaml [change etdofresh.com to your-domain.com]</p>
<pre><code>version: '3'
services:

  ghost:
    image: ghost:latest
    restart: always
    depends_on:
      - db
    environment:
      url: https://etdofresh.com
      database__client: mysql
      database__connection__host: db
      database__connection__user: root
      database__connection__password: your_database_root_password
      database__connection__database: ghost
    volumes:
      - ~/content:/var/lib/ghost/content

  db:
    image: mysql:5.7
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: your_database_root_password
    volumes:
      - ~/mysql:/var/lib/mysql

  nginx:
    image: nginx:latest
    restart: always
    depends_on:
      - ghost
    ports:
      - &quot;80:80&quot;
      - &quot;443:443&quot;
    volumes:
       - ~/letsencrypt:/etc/letsencrypt
       - ~/nginx-html:/usr/share/nginx/html
       - ~/nginx-conf:/etc/nginx/conf.d
</code></pre>
<p>Launch Docker-Compose</p>
<pre><code>docker-compose up -d
</code></pre>
<p>Open a bash into your nginx container</p>
<pre><code>docker ps ## Find NGINX_CONTAINER_ID [ie 6363edee96f6]
docker exec -it NGINX_CONTAINER_ID /bin/bash
</code></pre>
<p>Now you should be inside your nginx container. Run Let&rsquo;s Encrypt certbot</p>
<pre><code>apt-get update
apt-get install -y certbot python-certbot-nginx
certbot --nginx
</code></pre>
<p>Here how I answered the prompts&hellip;</p>
<pre><code>Saving debug log to /var/log/letsencrypt/letsencrypt.log
Plugins selected: Authenticator nginx, Installer nginx
Enter email address (used for urgent renewal and security notices) (Enter 'c' to
cancel): etdofresh@gmail.com

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Please read the Terms of Service at
https://letsencrypt.org/documents/LE-SA-v1.2-November-15-2017.pdf. You must
agree in order to register with the ACME server at
https://acme-v02.api.letsencrypt.org/directory
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
(A)gree/(C)ancel: A

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Would you be willing to share your email address with the Electronic Frontier
Foundation, a founding partner of the Let's Encrypt project and the non-profit
organization that develops Certbot? We'd like to send you email about our work
encrypting the web, EFF news, campaigns, and ways to support digital freedom.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
(Y)es/(N)o: N

Which names would you like to activate HTTPS for?
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
1: etdofresh.com
2: www.etdofresh.com
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Select the appropriate numbers separated by commas and/or spaces, or leave input
blank to select all options shown (Enter 'c' to cancel): *blank*

Obtaining a new certificate
Performing the following challenges:
http-01 challenge for etdofresh.com
http-01 challenge for www.etdofresh.com
2020/07/05 21:33:00 [notice] 1328#1328: signal process started
Waiting for verification...
Cleaning up challenges
2020/07/05 21:33:04 [notice] 1330#1330: signal process started
Deploying Certificate to VirtualHost /etc/nginx/conf.d/default.conf
Deploying Certificate to VirtualHost /etc/nginx/conf.d/default.conf
2020/07/05 21:33:07 [notice] 1332#1332: signal process started

Please choose whether or not to redirect HTTP traffic to HTTPS, removing HTTP access.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
1: No redirect - Make no further changes to the webserver configuration.
2: Redirect - Make all requests redirect to secure HTTPS access. Choose this for
new sites, or if you're confident your site works on HTTPS. You can undo this
change by editing your web server's configuration.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Select the appropriate number [1-2] then [enter] (press 'c' to cancel): 2

Redirecting all traffic on port 80 to ssl in /etc/nginx/conf.d/default.conf
Redirecting all traffic on port 80 to ssl in /etc/nginx/conf.d/default.conf
2020/07/05 21:33:24 [notice] 1334#1334: signal process started

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Congratulations! You have successfully enabled https://etdofresh.com and
https://www.etdofresh.com

You should test your configuration at:
https://www.ssllabs.com/ssltest/analyze.html?d=etdofresh.com
https://www.ssllabs.com/ssltest/analyze.html?d=www.etdofresh.com
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

IMPORTANT NOTES:
 - Congratulations! Your certificate and chain have been saved at:
   /etc/letsencrypt/live/etdofresh.com/fullchain.pem
   Your key file has been saved at:
   /etc/letsencrypt/live/etdofresh.com/privkey.pem
   Your cert will expire on 2020-10-03. To obtain a new or tweaked
   version of this certificate in the future, simply run certbot again
   with the &quot;certonly&quot; option. To non-interactively renew *all* of
   your certificates, run &quot;certbot renew&quot;
 - Your account credentials have been saved in your Certbot
   configuration directory at /etc/letsencrypt. You should make a
   secure backup of this folder now. This configuration directory will
   also contain certificates and private keys obtained by Certbot so
   making regular backups of this folder is ideal.
 - If you like Certbot, please consider supporting our work by:

   Donating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate
   Donating to EFF:                    https://eff.org/donate-le
</code></pre>
<p>If all went smoothly, you should be able to go to your website&rsquo;s ghost config</p>
<pre><code>https://your-domain.com/ghost
</code></pre>
<p><strong>Just my idea&hellip;. I haven&rsquo;t tested this yet</strong></p>
<p>Create a bash script /etc/letsencrpy/renew-docker.sh. [Don&rsquo;t forget to chmod +x renew-docker.sh]</p>
<pre><code>apt-get update
apt-get install -y certbot python-certbot-nginx
certbot certonly -n --webroot -w /usr/share/nginx/html -d etdofresh.com --deploy-hook='service nginx restart'
</code></pre>
<p>Then we could schedule to run this on a scheduled time period</p>
<pre><code>sudo crontab -e
</code></pre>
<p>And adding line to run every day at 11PM (or whatever you like)</p>
<pre><code>0 23 * * *   /etc/letsencrpy/renew-docker.sh
</code></pre>
<h2 id="references">References</h2>
<p><a href="https://www.linode.com/docs/websites/cms/ghost/how-to-install-ghost-cms-with-docker-compose-on-ubuntu-18-04/" title="https://www.linode.com/docs/websites/cms/ghost/how-to-install-ghost-cms-with-docker-compose-on-ubuntu-18-04/">https://www.linode.com/docs/websites/cms/ghost/how-to-install-ghost-cms-with-docker-compose-on-ubuntu-18-04/</a></p>
<p><a href="https://certbot.eff.org/lets-encrypt/debianstretch-nginx" title="https://certbot.eff.org/lets-encrypt/debianstretch-nginx">https://certbot.eff.org/lets-encrypt/debianstretch-nginx</a></p>

                </div>
            </section>

        </article>

    </div>
</main>
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
    
    <article class="read-next-card">
        <header class="read-next-card-header">
            <h3><span>More in</span> <a href="/tags/ghost">Ghost</a></h3>
        </header>
        <div class="read-next-card-content">
            <ul>
                
            </ul>
        </div>
    </article>
<article class="post-card post


 ">

        
            <a class="post-card-image-link" href="/stop-delete-all-docker-containers-images/">
                <img class="post-card-image"src="https://unsplash.com/photos/ZaGcU6BxJEc/download" alt="Stop/Delete All Docker Containers/Images"/>
            </a>
        
    
        <div class="post-card-content">
    
            <a class="post-card-content-link" href="/stop-delete-all-docker-containers-images/">
                <header class="post-card-header">
                    
                        
                        <div class="post-card-primary-tag">Docker</div>
                    

                    <h2 class="post-card-title">Stop/Delete All Docker Containers/Images</h2>
                </header>
    
                <section class="post-card-excerpt">
                    <p>Sometimes it&rsquo;s useful to start with a clean slate and remove all Docker containers and even images. Here are some handy shortcuts.
List all containers (only IDs) docker ps -aq  Stop all running containers docker stop $(docker ps -aq)  Remove all containers docker rm $(docker ps -aq)  Remove all images docker rmi $(docker images -q)  Copied from:
https://blog.baudson.de/blog/stop-and-remove-all-docker-containers-and-images</p>
                </section>
            </a>

            <footer class="post-card-meta">
                    <ul class="author-list">
                        <li class="author-list-item">
                            <div class="author-name-tooltip">ETdoFresh</div>
                            <a href="/author/ETdoFresh" class="static-avatar author-profile-image">
  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg>
</a>
                        </li>
                    </ul>
                    <div class="post-card-byline-content">
                        <span>ETdoFresh</span>
                        <span class="post-card-byline-date"><time datetime="2020-107-07">5 July 2020</time>
                            <span class="bull">&bull;</span> 1 min read</span>
                    </div>
                </footer>
            </div>
</article>
    

            <article class="post-card post


 ">

        
            <a class="post-card-image-link" href="/moving-from-ghost-to-hugo/">
                <img class="post-card-image"src="/uploads/2020/07/54194774_10102925179519048_4139436063376539648_n.jpg" alt="Moving from Ghost to Hugo"/>
            </a>
        
    
        <div class="post-card-content">
    
            <a class="post-card-content-link" href="/moving-from-ghost-to-hugo/">
                <header class="post-card-header">
                    
                        
                        <div class="post-card-primary-tag">Hugo</div>
                    

                    <h2 class="post-card-title">Moving from Ghost to Hugo</h2>
                </header>
    
                <section class="post-card-excerpt">
                    <p>Introduction After 1 or 2 days, I realized slimming down from WordPress to Ghost was just the beginning. I was somewhat satisfied. However, after setting up comments and looking at other integrations for Ghost, I feel like I&rsquo;m just using a mini/less functional WordPress. The markdown editing was the reason I made the switch, but then I realized, I might as well just scrap the database backend and keep all the files in a repo.</p>
                </section>
            </a>

            <footer class="post-card-meta">
                    <ul class="author-list">
                        <li class="author-list-item">
                            <div class="author-name-tooltip">ETdoFresh</div>
                            <a href="/author/ETdoFresh" class="static-avatar author-profile-image">
  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg>
</a>
                        </li>
                    </ul>
                    <div class="post-card-byline-content">
                        <span>ETdoFresh</span>
                        <span class="post-card-byline-date"><time datetime="2020-107-07">6 July 2020</time>
                            <span class="bull">&bull;</span> 3 min read</span>
                    </div>
                </footer>
            </div>
</article>
    
        </div>
    </div>
</aside>


        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="/">ETdoFresh</a> &copy; 2020</section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    <a href="https://facebook.com/etdofresh" target="_blank" rel="noopener">Facebook</a>
                    <a href="https://twitter.com/etdofresh" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://github.com/etdofresh" target="_blank" rel="noopener">Github</a>
                    <a href="https://jonathanjanssens.com" target="_blank" rel="noopener" style="opacity: 0.5;">Hugo Casper3 by Jonathan Janssens</a>
                </nav>
            </div>
        </footer>

    </div>

</body>
</html>